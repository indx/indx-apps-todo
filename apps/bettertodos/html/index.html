<html>
<head>
	<link rel="stylesheet" type="text/css" href="/css/angular-ui.css">
	<link rel="stylesheet" type="text/css" href="/css/select2.css">
	<link rel="stylesheet/less" type="text/css" href="/components/toolbar/toolbar.less">
	<link href="/css/jquery-ui.min.css" rel="stylesheet">
	<link rel="stylesheet/less" type="text/css" href="/css/indx-ui/indx-ui.less">
	<link rel="stylesheet/less" type="text/css" href="todos.less">
	<link href="/css/font-awesome.min.css" rel="stylesheet">
	<title>Todo list</title>
</head>
<body ng-app="todos" ng-controller="todos">
	<toolbar box-var='selectedBox' username-var='selectedUser'></toolbar>

	<div class="todos-messages alert alert-info" ng-if="msg">{{ msg }}</div>

	<div class="todos-main-body" ng-if="!msg">
		<div class="todos-sidebar">
			<ul>
				<li 	ng-repeat="list in lists" 
						ng-click="selectList(list)"
						class="special-{{ list.attributes.special[0] }}"
						ng-class="{	selected: list === s.selectedList,
									editing: list === s.editingList,
									loading: list.loading,
									special: list.attributes.special }">
					<form ng-submit="saveList(list)">
						<div class="title">
							<input 	type="text" 
									placeholder="My todo list"
									ng-model="list.staged.attributes.title[0]" 
									ng-disabled="list !== s.editingList"
									ng-blur="cancelEditList()"
									set-focus="list === s.editingList">
						</div>
						<div class="static count">{{ countTodos(list) }}</div>
						<div class="dropdown" ng-class="{ open: list.showDropdown }" ng-if="list !== s.editingList && !list.attributes.special[0]">
							<div class="dropdown-button" click-elsewhere="list.showDropdown = false" ng-click="list.showDropdown = !list.showDropdown"><i class="fa fa-caret-down"></i></div>
							<ul ng-show="list.showDropdown" class="dropdown-menu" >
								<li ng-click="editList(list)"><a href="#">Rename</a></li>
								<li ng-click="deleteList(list)"><a href="#">Delete</a></li>
							</ul>
						</div>
						<input type="submit">
					</form>
				</li>
				<li ng-click="createList()" ng-if="!s.editingList"><div class="title text-muted">New todo list</div></li>
			</ul>
		</div>
		<div class="todos-body">
			<div class="alert alert-info intro-step intro-step-create-list" ng-if="s.isFirstList">
				<i class="fa fa-long-arrow-left"></i>
				<h3>Create your first todo list</h3>
				<p>Enter a name for your list and press enter.</p>
			</div>
			<ul ng-if="s.selectedList.isCreated()">
				<li 	ng-repeat="todo in todos"
						ng-click="editTodo(todo)"
						ng-class="{	editing: todo === s.editingTodo,
									loading: todo.loading,
									completed: todo.attributes.completed[0] }">
					<a ng-click="createTodo(todo.attributes.order[0])" class="create-todo-link"  ng-if="!s.selectedList.attributes.special"><div class="line"></div><div class="i"><i class="fa fa-plus"></i></div></a>
					<form ng-submit="saveTodo(todo)">
						<div class="completedBox" ng-click="toggleTodoCompleted(todo)">
							<i class="fa fa-check" ng-if="todo.attributes.completed[0]"></i>
						</div>
						<div class="title">
							<input 	type="text" 
									placeholder="My todo"
									ng-model="todo.attributes.title[0]" 
									ng-disabled="todo !== s.editingTodo"
									ng-blur="(todo.attributes.title[0] === '') && cancelEditTodo()"
									set-focus="todo === s.editingTodo">
						</div>
					</form>
				</li>
				<li class="end-cap"><a ng-click="createTodo(todo.attributes.order[0])" class="create-todo-link" ng-if="!s.selectedList.attributes.special"><div class="line"></div><div class="i"><i class="fa fa-plus"></i></div></a></li>
			</ul>
			<div class="alert alert-info intro-step intro-step-create-todo" ng-if="!s.selectedList.attributes.special && s.selectedList.isCreated() && !todos.length">
				<i class="fa fa-long-arrow-up"></i>
				<h3>Create your first todo</h3>
				<p>Click the <i class="fa fa-plus"></i> button above.</p>
			</div>
		</div>
	</div>

	<script src="/js/vendor/lesscss.min.js" type="text/javascript"></script>
	<script src="/js/vendor/jquery.min.js" type="text/javascript"></script>
	<script src="/js/vendor/jquery-ui.min.js" type="text/javascript"></script>
	<script src="/js/vendor/underscore.min.js" type="text/javascript"></script>
	<script src="/js/vendor/backbone.min.js" type="text/javascript"></script>
	<!-- angular -->
	<script src="/js/vendor/angular.min.js" type="text/javascript"></script>
	<script src="/js/vendor/angular-ui.js" type="text/javascript"></script>

	<!-- indx -->
	<script src="/js/indx.js" type="text/javascript"></script>
	<script src="/js/indx-utils.js" type="text/javascript"></script>
	<script src="/js/indx-list-collection.js" type="text/javascript"></script>
	<script src="/components/toolbar/toolbar.js" type="text/javascript"></script>
	<script src="todos.js" type="text/javascript"></script>
	<script src="/js/vendor/bootstrap.min.js" type="text/javascript"></script>
</body>
</html>
