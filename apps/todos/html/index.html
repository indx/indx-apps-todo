<html>
  <head>
	<link rel="stylesheet" type="text/css" href="/css/angular-ui.css">
	<link rel="stylesheet" type="text/css" href="/css/select2.css">
	<link rel="stylesheet/less" type="text/css" href="/components/toolbar/toolbar.less">
	<link rel="stylesheet/less" type="text/css" href="css/todos.less">
	<link rel="stylesheet/less" type="text/css" href="/css/indx-ui/indx-ui.less">
	<link href="/css/font-awesome.min.css" rel="stylesheet">
	<link href="/css/jquery-ui.min.css" rel="stylesheet">
	<title>Todo list</title>
  </head>
  <body>
	<div ng-app="todos" ng-controller="todos" ng-cloak class="no-select">
  		<div class="alert alert-danger" ng-show="false">Failed to load</div>
			<toolbar box-var='selectedBox' username-var='selectedUser'></toolbar>

		<div ng-show="selectedUser && selectedBox" class="app-container" ng-class="{ split: showLists }">
			<div class="indx-navbars">
				<nav class="indx-navbar" role="navigation">
					<div href="#" class="navbar-header">
						<a href="#" class="navbar-header hidden-xs" ng-click="showLists = !showLists">
							<span class="navbar-brand">{{ todoLists.selected.getAttribute('title') }}</span>
							<span class="caret"></span>
						</a>
						<a href="#" class="navbar-header visible-xs" ng-click="mobileMenu = !mobileMenu">
							<span class="navbar-brand">{{ todoLists.selected.getAttribute('title') }}</span>
							<span class="caret"></span>
						</a>
					</div>
					<ul class="nav navbar-nav navbar-left hidden-xs">
						<li><a href="#" ng-click="todoLists.selected.edit()" ng-show="!editingTodo"><i class="icon-cog"></i></a></li>
					</ul>
					<ul class="nav navbar-nav navbar-right" ng-show="!editingTodo">
						<li ng-show="!search"><a href="#" ng-click="search = true"><i class="icon-search"></i></a></li>
						<li ng-show="search" ng-animate="'fade'">
							<form role="search">
								<div class="form-group">
									<div class="row">
										<div class="col-sm-2 col-xs-3">
											<button class="btn btn-default" ng-click="showCompleted = !showCompleted;" ng-class="{ active: showCompleted }" title="Show completed todos"><i class="icon-list"></i></button>
										</div>
										<div class="col-sm-10 col-xs-9">
											<input class="form-control" type="text" placeholder="search" ng-model="searchText">
											<a href="#" class="clearSearch" ng-click="searchText = ''; search = false;"><i class="icon-remove-sign"></i></a>
										</div>
									</div>
								</div>
							</form>
						</li>
  						<li><a href="#" ng-click="todoLists.selected.todos.newModel()"><i class="icon-plus"></i></a></li>
					</ul>
					<ul class="nav navbar-nav navbar-right" ng-show="editingTodo">
						<li><a href="#" ng-click="editingTodo.remove()"><i class="icon-trash"></i></a></li>
  						<li><a href="#" ng-click="editingTodo.saveStaged()"><i class="icon-ok"></i></a></li>
					</ul>
				</nav>
			</div>

			<div class="indx-content">
				<div class="visible-xs">
					<div class="slide-menu todo-list-menu" ng-show="mobileMenu" ng-animate="'slide-menu'">
						<ul class="nav nav-pills nav-stacked" ng-click="mobileMenu = false;">
							<li><a href="#" ng-click="todoLists.selected.edit()"><i class="icon-cog"></i> Todo list settings</a></li>
							<li ng-show="!showCompleted"><a href="#" ng-click="showCompleted = true"><i class="icon-check-empty"></i> Show completed todos</a></li>
							<li ng-show="showCompleted"><a href="#" ng-click="showCompleted = false"><i class="icon-check"></i> Hide completed todos</a></li>
							<li class="title">Todo lists</li>
							<li class="thick separator"></li>
							<li ng-class="{ active: todoList.isSelected }" ng-repeat="todoList in todoLists.allModels"><a href="#" ng-click="todoList.select()">
								<i class="icon-list"></i>
								{{ todoList.getAttribute('title') }}
							</a></li>
							<li class="separator"></li>
							<li><a href="#" ng-click="todoLists.selected.edit()"><i class="icon-plus"></i> New todo list</a></li>
		  				</ul>
					</div>

					<div class="modal-cover modal-fixed" ng-show="mobileMenu" ng-animate="fade" ng-click="mobileMenu = false"></div>
				</div>

				<div class="indx-sidebar">
					<ul class="indx-list-flat todo-lists">
						<li ng-repeat="todoList in todoLists.allModels" ng-class="{ active: todoList.isSelected }" >
							<a href="#" ng-click="todoList.select()" droppable>
								<i class="icon icon-{{ todoList.getAttribute('icon') }}"></i>
								{{ todoList.getAttribute('title') }}
							</a>
						</li>
						<li><a href="#" ng-click="todoLists.newModel()">
							<i class="icon icon-plus"></i>
							New list
						</a></li>
					</ul>
					<div class="modal-cover" ng-show="editingTodo" ng-animate="fade" ng-click="editingTodo.restore()"></div>
				</div>

				<div class="indx-main">
					<ul class="todo-list" ng-show="todoLists.selected" sortable>
						<li ng-repeat="todo in todoLists.selected.todos.allModels | filter:todosFilter" class="todo-item" ng-class="{
							completed: todo.attributes.completed[0],
							editing: todo.isEditing,
							disabled: !todo.isEditing && !!editingTodo,
							justcompleted: todo.justCompleted
						}" ng-include="'partials/todo.html'"  ng-click="todo.isEditing || editingTodo.restore();"></li>
					</ul>
				</div>
			</div>
		</div>


		<div ng-show="todoLists.selected.isEditing">

			<div class="modal-cover modal-fixed" ng-animate="fade" ng-click="todoLists.selected.restore()"></div>

			<div class="dlg-container">
				<div class="dlg">
					<div class="dlg-title">Edit todo list</div>
					<form ng-submit="todoLists.selected.saveStaged()">
						<div class="dlg-body">
							<input class="form-control" width="255" type="text" placeholder="Title" ng-model="todoLists.selected.stagedAttributes.title">
							<div class="todo-list-icons">
								<a href="#" ng-repeat="icon in icons" ng-click="todoLists.selected.stagedAttributes.icon = icon"><i class="icon icon-{{icon}}" ng-class="{active:todoLists.selected.getStagedAttribute('icon') === icon}"></i></a>
							</div>
							<button type="button" class="btn btn-danger" ng-click="todoLists.selected.remove()">Delete this todo list</button>
						</div>
						<div class="dlg-controls">
							<button type="button" ng-click="todoLists.selected.restore()">Close</button><button type="submit">Save</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
  </body>
  <script src="/js/vendor/lesscss.min.js" type="text/javascript"></script>
  <script src="/js/vendor/jquery.min.js" type="text/javascript"></script>
  <script src="/js/vendor/jquery-ui.min.js" type="text/javascript"></script>
  <script src="/js/vendor/underscore.min.js" type="text/javascript"></script>
  <script src="/js/vendor/backbone.min.js" type="text/javascript"></script>
  <script src="/js/vendor/bootstrap.min.js" type="text/javascript"></script>
  <!-- angular -->
  <script src="/js/vendor/angular.min.js" type="text/javascript"></script>
  <script src="/js/vendor/angular-ui.js" type="text/javascript"></script>

  <!-- indx -->
  <script src="/js/indx.js" type="text/javascript"></script>
  <script src="/js/indx-utils.js" type="text/javascript"></script>
  <script src="/js/indx-collection.js" type="text/javascript"></script>
  <script src="/components/toolbar/toolbar.js" type="text/javascript"></script>
  <script src="js/todos.js" type="text/javascript"></script>
  <script src="js/models.js" type="text/javascript"></script>
</html>
